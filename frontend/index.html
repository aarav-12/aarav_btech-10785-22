<!DOCTYPE html>
<html>
<head>
  <title>Kanban Board</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    .board { display: flex; gap: 20px; }
    .column { width: 30%; border: 1px solid #ccc; padding: 10px; }
    .task { border: 1px solid #999; padding: 8px; margin-bottom: 8px; }
  </style>
</head>
<body>

<h2>Task Management System</h2>
<a href="http://localhost:5000/auth/github">Login with GitHub</a>

<div class="board" id="board"></div>

<script>
async function loadTasks() {
  const res = await fetch("http://localhost:5000/tasks");
  const tasks = await res.json();

  const statuses = ["pending", "in-progress", "completed"];
  const board = document.getElementById("board");
  board.innerHTML = "";

  statuses.forEach(status => {
    const col = document.createElement("div");
    col.className = "column";
    col.innerHTML = `<h3>${status}</h3>`;

    tasks.filter(t => t.status === status).forEach(task => {
      const div = document.createElement("div");
      div.className = "task";
      div.innerHTML = `
        <b>${task.title}</b><br/>
        ${task.description}<br/>
        Due: ${task.due_date}<br/>
        <button onclick="move('${task.id}','pending')">P</button>
        <button onclick="move('${task.id}','in-progress')">IP</button>
        <button onclick="move('${task.id}','completed')">C</button>
      `;
      col.appendChild(div);
    });

    board.appendChild(col);
  });
}

async function move(id, status) {
  await fetch(`http://localhost:5000/tasks/${id}/status`, {
    method: "PATCH",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ status })
  });
  loadTasks();
}

loadTasks();
</script>

</body>
</html>
